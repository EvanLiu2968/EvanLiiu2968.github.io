{"version":3,"sources":["webpack:///./src/views/blog/game/TearCloth.vue?fc99","webpack:///src/views/blog/game/TearCloth.vue","webpack:///./src/views/blog/game/TearCloth.vue?4900","webpack:///./src/views/blog/game/TearCloth.vue","webpack:///./src/views/blog/game/TearCloth.vue?11a3"],"names":["canvas","ctx","cloth","boundsx","boundsy","render","_vm","this","_h","$createElement","_self","_c","_m","staticRenderFns","staticClass","attrs","physics_accuracy","mouse_influence","mouse_cut","gravity","cloth_height","cloth_width","start_y","spacing","tear_distance","window","requestAnimFrame","mouse","down","button","x","y","px","py","Point","vx","vy","pin_x","pin_y","constraints","prototype","update","diff_x","diff_y","dist","Math","sqrt","add_force","delta","nx","ny","draw","length","i","resolve_constraints","attach","push","remove_constraint","pin","pinx","piny","Constraint","p1","p2","resolve","diff","moveTo","lineTo","Cloth","points","start_x","width","p","clearRect","height","start","onmousedown","e","which","rect","getBoundingClientRect","clientX","left","clientY","top","preventDefault","onmouseup","onmousemove","oncontextmenu","strokeStyle","beginPath","stroke","data","mounted","document","getElementById","getContext","methods","onSubmit","$message","success","component"],"mappings":"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","file":"js/10.50d2809d.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"canvas-container\"}),_c('canvas',{attrs:{\"id\":\"tearCloth\"}})])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"canvas-container\"></div>\r\n    <canvas id=\"tearCloth\"></canvas>\r\n  </div>\r\n</template>\r\n<style scoped>\r\n.canvas-container{\r\n  position:absolute;\r\n  left:50%;\r\n  margin-left:-400px;\r\n  width:800px;\r\n  height:800px;\r\n  background-image: url('/public/images/hope/jump.jpg');\r\n  background-size:cover;\r\n}\r\n#tearCloth{\r\n  position:relative;\r\n  margin:0 auto;\r\n  width:800px;\r\n  height:800px;\r\n  display:block;\r\n  cursor:crosshair;\r\n  z-index:1\r\n}\r\n</style>\r\n<script>\r\nvar physics_accuracy = 3\r\nvar mouse_influence = 20\r\nvar mouse_cut = 5\r\nvar gravity = 1200\r\nvar cloth_height = 70\r\nvar cloth_width = 100\r\nvar start_y = 20\r\nvar spacing = 8\r\nvar tear_distance = 60\r\n\r\nwindow.requestAnimFrame =\r\n  window.requestAnimationFrame ||\r\n  window.webkitRequestAnimationFrame ||\r\n  window.mozRequestAnimationFrame ||\r\n  window.oRequestAnimationFrame ||\r\n  window.msRequestAnimationFrame ||\r\n  function(callback) {\r\n    window.setTimeout(callback, 1000 / 60)\r\n  }\r\n\r\nvar canvas\r\nvar ctx\r\nvar cloth\r\nvar boundsx\r\nvar boundsy\r\nvar mouse = {\r\n  down: false,\r\n  button: 1,\r\n  x: 0,\r\n  y: 0,\r\n  px: 0,\r\n  py: 0\r\n}\r\n\r\nvar Point = function(x, y) {\r\n  this.x = x\r\n  this.y = y\r\n  this.px = x\r\n  this.py = y\r\n  this.vx = 0\r\n  this.vy = 0\r\n  this.pin_x = null\r\n  this.pin_y = null\r\n\r\n  this.constraints = []\r\n}\r\n\r\nPoint.prototype.update = function(delta) {\r\n  if (mouse.down) {\r\n    var diff_x = this.x - mouse.x\r\n    var diff_y = this.y - mouse.y\r\n    var dist = Math.sqrt(diff_x * diff_x + diff_y * diff_y)\r\n\r\n    if (mouse.button == 1) {\r\n      if (dist < mouse_influence) {\r\n        this.px = this.x - (mouse.x - mouse.px) * 1.8\r\n        this.py = this.y - (mouse.y - mouse.py) * 1.8\r\n      }\r\n    } else if (dist < mouse_cut) this.constraints = []\r\n  }\r\n\r\n  this.add_force(0, gravity)\r\n\r\n  delta *= delta\r\n  const nx = this.x + ((this.x - this.px) * 0.99) + ((this.vx / 2) * delta)\r\n  const ny = this.y + ((this.y - this.py) * 0.99) + ((this.vy / 2) * delta)\r\n\r\n  this.px = this.x\r\n  this.py = this.y\r\n\r\n  this.x = nx\r\n  this.y = ny\r\n\r\n  this.vy = this.vx = 0\r\n}\r\n\r\nPoint.prototype.draw = function() {\r\n  if (this.constraints.length <= 0) return\r\n\r\n  var i = this.constraints.length\r\n  while (i--) this.constraints[i].draw()\r\n}\r\n\r\nPoint.prototype.resolve_constraints = function() {\r\n  if (this.pin_x != null && this.pin_y != null) {\r\n    this.x = this.pin_x\r\n    this.y = this.pin_y\r\n    return\r\n  }\r\n\r\n  var i = this.constraints.length\r\n  while (i--) this.constraints[i].resolve()\r\n\r\n  if (this.x > boundsx) {\r\n    this.x = 2 * boundsx - this.x\r\n  } else if (this.x < 1) {\r\n    this.x = 2 - this.x\r\n  }\r\n\r\n  if (this.y > boundsy) {\r\n    this.y = 2 * boundsy - this.y\r\n  } else if (this.y < 1) {\r\n    this.y = 2 - this.y\r\n  }\r\n}\r\n\r\nPoint.prototype.attach = function(point) {\r\n  this.constraints.push(\r\n    new Constraint(this, point)\r\n  )\r\n}\r\n\r\nPoint.prototype.remove_constraint = function(lnk) {\r\n  var i = this.constraints.length\r\n  while (i--) { if (this.constraints[i] == lnk) this.constraints.splice(i, 1) }\r\n}\r\n\r\nPoint.prototype.add_force = function(x, y) {\r\n  this.vx += x\r\n  this.vy += y\r\n}\r\n\r\nPoint.prototype.pin = function(pinx, piny) {\r\n  this.pin_x = pinx\r\n  this.pin_y = piny\r\n}\r\n\r\nvar Constraint = function(p1, p2) {\r\n  this.p1 = p1\r\n  this.p2 = p2\r\n  this.length = spacing\r\n}\r\n\r\nConstraint.prototype.resolve = function() {\r\n  var diff_x = this.p1.x - this.p2.x\r\n  var diff_y = this.p1.y - this.p2.y\r\n  var dist = Math.sqrt(diff_x * diff_x + diff_y * diff_y)\r\n  var diff = (this.length - dist) / dist\r\n\r\n  if (dist > tear_distance) this.p1.remove_constraint(this)\r\n\r\n  var px = diff_x * diff * 0.5\r\n  var py = diff_y * diff * 0.5\r\n\r\n  this.p1.x += px\r\n  this.p1.y += py\r\n  this.p2.x -= px\r\n  this.p2.y -= py\r\n}\r\n\r\nConstraint.prototype.draw = function() {\r\n  ctx.moveTo(this.p1.x, this.p1.y)\r\n  ctx.lineTo(this.p2.x, this.p2.y)\r\n}\r\n\r\nvar Cloth = function() {\r\n  this.points = []\r\n\r\n  var start_x = canvas.width / 2 - cloth_width * spacing / 2\r\n\r\n  for (var y = 0; y <= cloth_height; y++) {\r\n    for (var x = 0; x <= cloth_width; x++) {\r\n      var p = new Point(start_x + x * spacing, start_y + y * spacing)\r\n\r\n      x != 0 && p.attach(this.points[this.points.length - 1])\r\n      y == 0 && p.pin(p.x, p.y)\r\n      y != 0 && p.attach(this.points[x + (y - 1) * (cloth_width + 1)])\r\n\r\n      this.points.push(p)\r\n    }\r\n  }\r\n}\r\n\r\nCloth.prototype.update = function() {\r\n  var i = physics_accuracy\r\n\r\n  while (i--) {\r\n    var p = this.points.length\r\n    while (p--) this.points[p].resolve_constraints()\r\n  }\r\n\r\n  i = this.points.length\r\n  while (i--) this.points[i].update(0.016)\r\n}\r\n\r\nCloth.prototype.draw = function() {\r\n  ctx.beginPath()\r\n\r\n  var i = cloth.points.length\r\n  while (i--) cloth.points[i].draw()\r\n\r\n  ctx.stroke()\r\n}\r\n\r\nfunction update() {\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n\r\n  cloth.update()\r\n  cloth.draw()\r\n\r\n  window.requestAnimFrame(update)\r\n}\r\n\r\nfunction start() {\r\n  canvas.onmousedown = function(e) {\r\n    mouse.button = e.which\r\n    mouse.px = mouse.x\r\n    mouse.py = mouse.y\r\n    var rect = canvas.getBoundingClientRect()\r\n    mouse.x = e.clientX - rect.left\r\n    mouse.y = e.clientY - rect.top\r\n    mouse.down = true\r\n    e.preventDefault()\r\n  }\r\n\r\n  canvas.onmouseup = function(e) {\r\n    mouse.down = false\r\n    e.preventDefault()\r\n  }\r\n\r\n  canvas.onmousemove = function(e) {\r\n    mouse.px = mouse.x\r\n    mouse.py = mouse.y\r\n    var rect = canvas.getBoundingClientRect()\r\n    mouse.x = e.clientX - rect.left\r\n    mouse.y = e.clientY - rect.top\r\n    e.preventDefault()\r\n  }\r\n\r\n  canvas.oncontextmenu = function(e) {\r\n    e.preventDefault()\r\n  }\r\n\r\n  boundsx = canvas.width - 1\r\n  boundsy = canvas.height - 1\r\n\r\n  ctx.strokeStyle = '#fff'\r\n  cloth = new Cloth()\r\n  update()\r\n}\r\n\r\nexport default {\r\n  data: function() {\r\n    return {\r\n    }\r\n  },\r\n  mounted: function() {\r\n    canvas = document.getElementById('tearCloth')\r\n    ctx = canvas.getContext('2d')\r\n\r\n    canvas.width = 800// 560\r\n    canvas.height = 800// 350\r\n\r\n    start()\r\n  },\r\n  methods: {\r\n    onSubmit() {\r\n      this.$message.success('提交成功！')\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TearCloth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TearCloth.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TearCloth.vue?vue&type=template&id=0e4c4aa7&scoped=true&\"\nimport script from \"./TearCloth.vue?vue&type=script&lang=js&\"\nexport * from \"./TearCloth.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TearCloth.vue?vue&type=style&index=0&id=0e4c4aa7&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0e4c4aa7\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TearCloth.vue?vue&type=style&index=0&id=0e4c4aa7&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TearCloth.vue?vue&type=style&index=0&id=0e4c4aa7&scoped=true&lang=css&\""],"sourceRoot":""}